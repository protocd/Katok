# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞:
```sql
SELECT * FROM users WHERE email = 'user@example.com';
```
- MySQL –ø—Ä–æ–≤–µ—Ä—è–µ—Ç **–∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É** –≤ —Ç–∞–±–ª–∏—Ü–µ (–ø–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã)
- –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ 100,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ 100,000 —Å—Ç—Ä–æ–∫
- –í—Ä–µ–º—è: O(n) - –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è

### –° –∏–Ω–¥–µ–∫—Å–æ–º:
```sql
-- –ò–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–Ω: INDEX idx_email (email)
SELECT * FROM users WHERE email = 'user@example.com';
```
- MySQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å (B-tree —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- –ù–∞—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É –∑–∞ **–ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è** O(log n)
- –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ 100,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 17 —Å—Ç—Ä–æ–∫ (log‚ÇÇ(100000) ‚âà 17)
- **–í 1000+ —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!**

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:

**–ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ (–ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫):**
```
[user1] ‚Üí [user2] ‚Üí [user3] ‚Üí ... ‚Üí [user99999] ‚Üí [user100000]
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É
```

**–° –∏–Ω–¥–µ–∫—Å–æ–º (B-tree):**
```
        [email: m]
       /          \
   [a-g]         [h-z]
   /    \        /    \
[a-c] [d-g]  [h-m] [n-z]
  |     |      |     |
–ù–∞—Ö–æ–¥–∏—Ç –∑–∞ 3-4 —à–∞–≥–∞ –≤–º–µ—Å—Ç–æ 100000
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:

**–¢–∞–±–ª–∏—Ü–∞ users —Å 1,000,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ | –° –∏–Ω–¥–µ–∫—Å–æ–º | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|----------|-------------|------------|-----------|
| –ü–æ–∏—Å–∫ –ø–æ email | ~1000ms | ~1ms | **1000x** |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | –ú–µ–¥–ª–µ–Ω–Ω–æ | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ | ‚úÖ |

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ ENGINE=InnoDB?

**ENGINE** - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ MySQL.

### InnoDB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
- ‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ACID
- ‚úÖ **–í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏** (FOREIGN KEY) - —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫** - –ª—É—á—à–µ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ **–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** (ROLLBACK)
- ‚úÖ **–ö—Ä–∞—à-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ–µ

### MyISAM (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π):
- ‚ùå –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚ùå –ù–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π
- ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚ö° –ë—ã—Å—Ç—Ä–µ–µ –¥–ª—è —á—Ç–µ–Ω–∏—è (–Ω–æ –Ω–µ –¥–ª—è –∑–∞–ø–∏—Å–∏)

**–í—ã–≤–æ–¥:** InnoDB - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ CHARSET=utf8mb4?

**CHARSET** - –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤.

### utf8mb4 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≤—Å–µ** —Å–∏–º–≤–æ–ª—ã Unicode
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–º–æ–¥–∑–∏ üòÄ üéø ‚õ∏Ô∏è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
- ‚úÖ 4 –±–∞–π—Ç–∞ –Ω–∞ —Å–∏–º–≤–æ–ª (mb4 = multi-byte 4)

### utf8 (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π):
- ‚ùå –¢–æ–ª—å–∫–æ 3 –±–∞–π—Ç–∞ –Ω–∞ —Å–∏–º–≤–æ–ª
- ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–º–æ–¥–∑–∏
- ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π

**–ü—Ä–∏–º–µ—Ä:**
```sql
-- –° utf8mb4 —Ä–∞–±–æ—Ç–∞–µ—Ç:
INSERT INTO users (name) VALUES ('–ò–≤–∞–Ω üòÄ');

-- –° utf8 –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å —ç–º–æ–¥–∑–∏
```

**–í—ã–≤–æ–¥:** utf8mb4 - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤ –∏ —ç–º–æ–¥–∑–∏!

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ COLLATE=utf8mb4_unicode_ci?

**COLLATE** - –ø—Ä–∞–≤–∏–ª–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–∏–º–≤–æ–ª–æ–≤.

### utf8mb4_unicode_ci:
- **unicode** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ Unicode –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- **ci** = case-insensitive (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)

### –ü—Ä–∏–º–µ—Ä—ã:

```sql
-- –° utf8mb4_unicode_ci:
SELECT * FROM users WHERE email = 'USER@EXAMPLE.COM';
-- –ù–∞–π–¥–µ—Ç: user@example.com, User@Example.Com, USER@EXAMPLE.COM
-- (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)

-- –° utf8mb4_bin (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É):
SELECT * FROM users WHERE email = 'USER@EXAMPLE.COM';
-- –ù–ï –Ω–∞–π–¥–µ—Ç: user@example.com
```

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:

```sql
-- –° utf8mb4_unicode_ci:
SELECT * FROM users ORDER BY name;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ê–Ω—è, –ë–æ—Ä–∏—Å, –í–∞–Ω—è (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä—É—Å—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)

-- –° utf8mb4_bin:
SELECT * FROM users ORDER BY name;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ –∫–æ–¥–∞–º —Å–∏–º–≤–æ–ª–æ–≤ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
```

**–í—ã–≤–æ–¥:** utf8mb4_unicode_ci - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º!

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞:

```sql
ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- **ENGINE=InnoDB** - –∏—Å–ø–æ–ª—å–∑—É–µ–º InnoDB (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏)
- **CHARSET=utf8mb4** - –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤ Unicode
- **COLLATE=utf8mb4_unicode_ci** - –ø—Ä–∞–≤–∏–ª–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)

**–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!** ‚úÖ
