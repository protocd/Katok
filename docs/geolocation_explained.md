# Объяснение проверки геолокации и working_hours

## Проверка геолокации (GPS не всегда точный)

### Проблема:
GPS на мобильных устройствах не всегда работает точно:
- Погрешность может быть 10-50 метров
- В помещении GPS может не работать вообще
- В городе между зданиями точность снижается
- Пользователь может быть на катке, но GPS показывает расстояние 100+ метров

### Решение:
**Увеличенный радиус проверки до 1 км (1000 метров)**

```php
// В классе Checkin
const MAX_DISTANCE_METERS = 1000; // 1 км вместо 500 м

// Проверка расстояния
$distance = $this->calculateDistance($userLat, $userLon, $rinkLat, $rinkLon);

if ($distance > self::MAX_DISTANCE_METERS) {
    throw new Exception("Вы находитесь слишком далеко от катка. Расстояние: " . 
                      round($distance) . " м (максимум " . self::MAX_DISTANCE_METERS . " м)");
}
```

### Почему 1 км?
- ✅ Учитывает неточность GPS
- ✅ Пользователь может быть на катке, но GPS показывает 200-300 метров
- ✅ Все еще защищает от накруток (нельзя отметить из дома)
- ✅ Разумный компромисс между удобством и безопасностью

### Альтернативные варианты:
- **500 м** - слишком строго, много ложных отказов
- **1 км** - оптимально ✅ (текущий вариант)
- **2 км** - слишком мягко, можно накручивать из соседних зданий

---

## Зачем working_hours в таблице rinks?

### Это базовые данные из открытых данных Правительства Москвы

**working_hours** - это официальная информация о графике работы катка, которая приходит из открытых данных.

### Зачем это нужно:

1. **Базовая информация о катке:**
   - Когда каток работает
   - В какие дни открыт
   - В какое время можно прийти

2. **Помощь пользователям:**
   - Пользователь видит официальное расписание
   - Может планировать посещение
   - Не нужно искать информацию в других источниках

3. **Сравнение с реальностью:**
   - Пользователи могут оставить отзыв: "Официально работает до 22:00, но вчера закрыли в 21:00"
   - Полезная информация для других пользователей

4. **Источник данных:**
   - Это часть открытых данных Правительства Москвы
   - Мы обязаны указать источник данных
   - Это официальная информация о катке

### Пример данных:

```json
{
  "name": "Каток в Парке Горького",
  "working_hours": "Пн-Вс: 10:00-22:00",
  "address": "Крымский Вал, 9"
}
```

### Отличие от мероприятий:

- **working_hours** - официальное расписание работы катка (из открытых данных)
- **events** - мероприятия, созданные пользователями (например, "догонялки в 18:00")

**Это разные вещи!** ✅

---

## Итог:

1. **Геолокация:** Радиус проверки увеличен до 1 км из-за неточности GPS
2. **working_hours:** Базовые данные из открытых данных, нужны для информации о катке
3. **Фото в отзывах:** Добавлено поле photo_path/photo_url прямо в таблицу reviews
